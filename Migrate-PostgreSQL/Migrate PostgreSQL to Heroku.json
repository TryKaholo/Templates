{"content":"{\"cells\":[{\"type\":\"devs.PMStartPoint\",\"size\":{\"width\":40,\"height\":39},\"outPorts\":[\" \"],\"inPorts\":[],\"ports\":{\"groups\":{\"in\":{\"position\":{\"name\":\"left\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"left\",\"args\":{\"y\":10}}}},\"out\":{\"position\":{\"name\":\"right\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"right\",\"args\":{\"y\":10}}}}},\"items\":[{\"id\":\" \",\"group\":\"out\",\"attrs\":{\".port-label\":{\"text\":\" \"}}}]},\"position\":{\"x\":38,\"y\":-130},\"angle\":0,\"id\":\"894995e2-b1e3-4f8d-a0f1-14826803e2a6\",\"z\":1,\"attrs\":{\"rect\":{\"fill\":\"#2d3236\"}}},{\"type\":\"devs.MyImageModel\",\"size\":{\"width\":100,\"height\":73},\"inPorts\":[\" \"],\"outPorts\":[\"  \"],\"ports\":{\"groups\":{\"in\":{\"position\":{\"name\":\"left\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"left\",\"args\":{\"y\":10}}}},\"out\":{\"position\":{\"name\":\"right\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"right\",\"args\":{\"y\":10}}}}},\"items\":[{\"id\":\" \",\"group\":\"in\",\"attrs\":{\".port-label\":{\"text\":\" \"}}},{\"id\":\"  \",\"group\":\"out\",\"attrs\":{\".port-label\":{\"text\":\"  \"}}}]},\"position\":{\"x\":131,\"y\":-144},\"angle\":0,\"id\":\"f968eee3-fc08-4bb7-960d-71da00131f85\",\"z\":2,\"attrs\":{\"rect\":{\"stroke-width\":1,\"fill-opacity\":0.5,\"fill\":\"#2d3236\"},\".label\":{\"text\":\"Make Dump\"},\".p_id\":{\"text\":\"61fd370f74918000329ce57b\"},\"image\":{\"xlink:href\":\"/plugins/CommandLine/CommandLine.png\",\"ref-y\":50},\"text\":{\"text\":\"Make Dump\"}}},{\"type\":\"devs.MyImageModel\",\"size\":{\"width\":100,\"height\":73},\"inPorts\":[\" \"],\"outPorts\":[\"  \"],\"ports\":{\"groups\":{\"in\":{\"position\":{\"name\":\"left\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"left\",\"args\":{\"y\":10}}}},\"out\":{\"position\":{\"name\":\"right\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"right\",\"args\":{\"y\":10}}}}},\"items\":[{\"id\":\" \",\"group\":\"in\",\"attrs\":{\".port-label\":{\"text\":\" \"}}},{\"id\":\"  \",\"group\":\"out\",\"attrs\":{\".port-label\":{\"text\":\"  \"}}}]},\"position\":{\"x\":292,\"y\":-144},\"angle\":0,\"id\":\"836cc5a7-8643-402e-937b-9a303ccb5baa\",\"z\":7,\"attrs\":{\"rect\":{\"stroke-width\":1,\"fill-opacity\":0.5,\"fill\":\"#2d3236\"},\".label\":{\"text\":\"Restore Database\"},\".p_id\":{\"text\":\"61fd370f74918000329ce57b\"},\"image\":{\"xlink:href\":\"/plugins/CommandLine/CommandLine.png\",\"ref-y\":50},\"text\":{\"text\":\"Restore Database\"}}},{\"type\":\"link\",\"source\":{\"id\":\"894995e2-b1e3-4f8d-a0f1-14826803e2a6\",\"port\":\" \"},\"target\":{\"id\":\"f968eee3-fc08-4bb7-960d-71da00131f85\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"ea87eace-1840-4cc3-8a3a-e7d374c16253\",\"z\":8,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"link\",\"source\":{\"id\":\"f968eee3-fc08-4bb7-960d-71da00131f85\",\"port\":\"  \"},\"target\":{\"id\":\"836cc5a7-8643-402e-937b-9a303ccb5baa\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"4df0f65d-04e0-4719-9cd2-ed5bae957e70\",\"z\":9,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}}]}","code":"function makeDump() {\n    host = kaholo.execution.configuration.Host\n    database = kaholo.execution.configuration.Database\n    user = kaholo.execution.configuration.User\n    port = kaholo.execution.configuration.Port\n    password = kaholo.execution.configuration.Password\n    return `PGUSER=${user} PGDATABASE=${database} PGPASSWORD=${password} pg_dump -Fc -h ${host} > mydb_backup.dump`\n}\n\nfunction restoreDump() {\n    host = kaholo.execution.configuration.NewHost\n    database = kaholo.execution.configuration.NewDatabase\n    user = kaholo.execution.configuration.NewUser\n    port = kaholo.execution.configuration.NewPort\n    password = kaholo.execution.configuration.NewPassword\n    return `PGUSER=${user} PGPASSWORD=${password} pg_restore -h ${host} -C -d ${database} mydb_backup.dump`\n}\n","plugins":[],"processes":[{"id":"622b3d3d6a58a900344c6449","uuid":"f968eee3-fc08-4bb7-960d-71da00131f85","codeId":"pgDump","name":"Make Dump","description":"This step dumps the database and stores it on the agent. Make sure PostgreSQL is installed on the agent and its version is equal to or higher than the version of PostgreSQL on the remote server.","mandatory":true,"coordination":"","condition":"","preRun":"","postRun":"","filterAgents":"","actionsExecution":"series","actions":[{"retries":null,"timeout":null,"name":"Make Dump","mandatory":true,"method":"execute","params":[{"value":"/root","code":null,"id":"61fd370f74918000329ce57d","_id":"61fd370f74918000329ce57d","viewName":"Working Directory","name":"workingDir","required":false,"param":"61fd370f74918000329ce57d","type":"string"},{"value":"makeDump()","code":true,"id":"61fd370f74918000329ce57e","_id":"61fd370f74918000329ce57e","viewName":"Command","name":"COMMANDS","required":false,"param":"61fd370f74918000329ce57e","type":"string"},{"value":null,"code":null,"id":"61fd370f74918000329ce57f","_id":"61fd370f74918000329ce57f","viewName":"Wait For Close","name":"exitOnClose","required":false,"param":"61fd370f74918000329ce57f","type":"boolean"},{"value":null,"code":null,"id":"61fd370f74918000329ce580","_id":"61fd370f74918000329ce580","viewName":"Shell Type","name":"shell","required":false,"param":"61fd370f74918000329ce580","type":"options"}],"isEnabled":true,"numParallel":""}],"used_plugin":{"name":"CommandLine","version":"3.0.2"},"correlateAgents":null,"numProcessParallel":""},{"id":"622b3d3d6a58a900344c6454","uuid":"836cc5a7-8643-402e-937b-9a303ccb5baa","codeId":"pgRestore","name":"Restore Database","description":"In this step, the agent uses the database dump to restore it on the remote server.","mandatory":true,"coordination":"","condition":"","preRun":"","postRun":"","filterAgents":"","actionsExecution":"series","actions":[{"retries":null,"timeout":null,"name":"Restore Database","mandatory":true,"method":"execute","params":[{"value":"/root","code":null,"id":"61fd370f74918000329ce57d","_id":"61fd370f74918000329ce57d","viewName":"Working Directory","name":"workingDir","required":false,"param":"61fd370f74918000329ce57d","type":"string"},{"value":"restoreDump()","code":true,"id":"61fd370f74918000329ce57e","_id":"61fd370f74918000329ce57e","viewName":"Command","name":"COMMANDS","required":false,"param":"61fd370f74918000329ce57e","type":"string"},{"value":null,"code":null,"id":"61fd370f74918000329ce57f","_id":"61fd370f74918000329ce57f","viewName":"Wait For Close","name":"exitOnClose","required":false,"param":"61fd370f74918000329ce57f","type":"boolean"},{"value":null,"code":null,"id":"61fd370f74918000329ce580","_id":"61fd370f74918000329ce580","viewName":"Shell Type","name":"shell","required":false,"param":"61fd370f74918000329ce580","type":"options"}],"isEnabled":true,"numParallel":""}],"used_plugin":{"name":"CommandLine","version":"3.0.2"},"correlateAgents":null,"numProcessParallel":""}],"configurations":[{"name":"Database Migration Configuration","value":"{\n    \"Host\": \"ec2-35-170-123-64.compute-1.amazonaws.com\",\n    \"Database\": \"dauds58eh9l3nf\",\n    \"User\": \"yqzdmgdyhipaap\",\n    \"Port\": \"5432\",\n    \"Password\": \"518db074f137d438227fcd74b9bea81369ce71bb504f96a99a34e45f7a6f52ab\",\n\n    \"NewHost\": \"3.251.98.55\",\n    \"NewDatabase\": \"postgres\",\n    \"NewUser\": \"admin\",\n    \"NewPort\": \"5432\",\n    \"NewPassword\": \"password\"\n}","_id":"622b3d3d6a58a900344c645c"}],"links":[{"uuid":"ea87eace-1840-4cc3-8a3a-e7d374c16253","sourceId":"894995e2-b1e3-4f8d-a0f1-14826803e2a6","targetId":"f968eee3-fc08-4bb7-960d-71da00131f85"},{"uuid":"4df0f65d-04e0-4719-9cd2-ed5bae957e70","sourceId":"f968eee3-fc08-4bb7-960d-71da00131f85","targetId":"836cc5a7-8643-402e-937b-9a303ccb5baa"}],"used_plugins":[{"name":"CommandLine","version":"3.0.2"},{"name":"TextEditor","version":"1.1.2"},{"name":"CommandLine","version":"3.0.2"}]}